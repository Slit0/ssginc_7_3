
Servlet/JSP 강좌정리

1.  자바 개발 플랫폼 3가지
 
  1) Java SE ( Java Standard Edition)
      - 자바 spec.
      - 환경구축방법: JDK 17 설치
      - 개발프로그램 형태: 비웹 환경의 로컬로 실행되는 프로그램 개발이 가능.

  2) Java EE ( Java Enterprise Edition )
     
      - Servlet/JSP spec. ( spec는 인터페이스 라고 생각하자 )
        실제로 Servlet/JSP spec를 구현한 구현체는 Tomcat 서버가 제공하는 구현체를 사용할 것이다.

	  예>    오라클(Servlet/JSP spec 제공: 인터페이스)
	              |
	     Tomcat서버       Resin서버   ... 
            (Servlet/JSP spec를 구현함. .jar 형태로 제공)
      
      - jsp-api.jar 와 servlet-api.jar 가 제공됨.
      - 개발프로그램 형태: 웹 어플리케이션 개발이 가능.

  3) Java ME ( Java Micro Edition )
      - 개발프로그램 형태:  휴대용 장치에서 실행되는 개발이 가능.
     

2. 환경설정

  1) Java SE 환경 구축: JDK 17 설치

     - JDK 설치후 2개의 환경변수 설정
      JAVA_HOME=C:\Program Files\Java\jdk-17  <=== JDK의 홈디렉터리 경로 설정
      PATH=%JAVA_HOME%\bin;기본PATH                                   <=== 윈도우의 프로그램에 명령어 경로 설정
           C:\Program Files\Java\jdk-17\bin;기본PATH   
  
  2) Eclipse 설치
     - http://www.eclipse.org
     - JDK 17 지원여부 확인 필수.
     - eclipse-jee-2024-06-R-win32-x86_64.zip
       설치는 압축풀면 됨.
  
  3) Tomcat 서버 ( Tomcat 컨테이너 )
    
     - http://jakarta.apache.org 
     - JDK 17 버전을 지원하는 Tomcat 10 다운로드.
     - jsp-api.jar 와 servlet-api.jar 가 제공됨.
       ( Servlet 6.0 and Pages 3.1 )
     - apache-tomcat-10.1.28.zip
       설치는 압축풀면 됨.

     - 기본 port 번호: 8080  ( 만약 Oracle DB 설치하면 내부적으로 tomcat을 설치함(8080) )

    * tomcat9 vs tomcat10
 
       tomcat9: JDK11까지만 지원됨.
                패키지명은 javax.servlet 로 시작됨.
		패키지 관리를 Oracle로 했음.

       tomcat10: JDK17부터 지원됨.
                패키지명은 jakarta.servlet 로 시작됨.
                패키지 관리를 Oracle 아닌 Apache에서 관리함.
                
             서블릿관련 API 문서
	     https://tomcat.apache.org/tomcat-10.1-doc/servletapi/index.html

     - 필요시 환경변수 설정가능

       CATALINA_HOME=C:\servlet_study\apache-tomcat-10.1.28  <== bin 디렉터리 전까지
       


3. eclipse 와 Tomcat 연동

 1) eclipse 실행
   - C:\servlet_study\eclipse 에 workspace 작성
   - C:\servlet_study\eclipse\workspace 경로를 작업디렉터리로 지정
   - Java EE 퍼스펙티브 선택 ( 기본 )
   - 한글인코딩 설정
      a. window > preference > general > workspace 선택하고 text file encoding 값을 utf-8 로 설정 (기본)
      b. window > preference > web > html,css,jsp 선택하고 Encoding 값을 utf-8 로 설정 (기본)

   - JDK 17로 변경
 
      window > preference > java > compiler > 17 로 변경   
      window > preference > java > installed JRES >  기존 jre 체크된 것은 삭제하고 
                                                     우리 환경에 맞는 C:\Program Files\Java\jdk-17 선택.
     

  2) eclipse와 tomcat 연동 (*****************)

     - 교안 13 페이지 참조.



4. 프로젝트 생성

   - File > New > Dynamic Web Project 선택.  ( 프로젝트명: HelloTest )
   - Web Module 에서 출력된 내용은 다음과 같다.

     1) Context Root
       - 기본값은 프로젝트명으로 되어있음. ( 언제든지 변경 가능 )
       - 웹브라우저에서 요청시 사용됨.


           http://localhost:8090/컨텍스트명

	   예> http://localhost:8090/a
 

         컨텍스트명(논리적인경로       webapps안의 실제폴더(물리적인 경로, 웹어플리케이션)
        --------               -----------------------
          docs                   docs        <== http://localhost:8090/docs/index.html
	 examples		 examples     <== http://localhost:8090/examples/index.html
	    /			 ROOT        <== http://localhost:8090/index.jsp
	                                         http://localhost:8090/ 
						 ( servers > web.xml >  <welcome-file-list> 태그안에
						   메인 홈 페이지에 해당하는 파일명이 설정되어있음.
						   이 파일명은 url에 지정하지 않아도 자동으로 찾음 )

	   a                     HelloTest  <== http://localhost:8090/a

      - 용도: 실제 tomcat의 배포경로(depoy path)인 webapps 에 만들어지는 물리적인 폴더인 웹어플리케이션을
             찾을때 사용하는 논리적인 이름을 context라고 부른다.

      - 변경방법
        이클립스 servers 탭 > tomcat 서버 클릭 > module > edit > Path 에  context명 수정( 반드시  / 로 시작)

   2) Content Directory

      - 개발자가 만든 소스가 저장되는 eclipse 디렉터리이다.


   
   3) web.xml
    
     - 배치 지시자 ( deployment descriptor )라고 부르고
       생성된 웹 어플리케이션(HelloTest)의 전반적인 설정정보 담당하는 역할.

     * 웹 어플리케이션 설정 정보를 등록하는 방법 2가지
      
       가. web.xml

       나. 어노테이션 ( @ 으로 시작 )
         예> @WebServlet()
	     ....



5. eclipse 에서 생성된 웹 어플리케이션 디렉터리 구조

    HelloTest
      Java Resource
          src/main/java  <== 소스파일( java ) 저장
	  libraries
	     JRE System Library <== JDK 라이브러리
	     Server Runtime     <== jsp-api.jar 와 servlet-api.jar

      src
         main
	     java   <== 소스파일( java ) 저장

	     webapp <== 웹 관련 파일(html,jsp,css,js,img등)이 이클립스에 저장하는 디렉터리이다.
	       
	        WEB-INF <== 대문자로 지정, 웹 어플리케이션에서는 필수.
		            WEB-INF 폴더내에 저장된 파일은 웹 브라우저에서(외부) 접근이 불가 ( 보안 이슈 )
			    
		    lib  <== 외부에서 가져와서 사용하는 라이브러리(.jar) 등록 폴더.
		           나중에 mybatis.jar 와 mysql-connector.jar 2개의 jar 파일을 저장할 예정임.

		    web.xml  <== 웹 어플리케이션(HelloTest)의 전반적인 설정정보 담당.

	        *.html 
		*.jsp  <== jsp 파일
		*.css
		*.js
		image


  6. tomcat 의 배포된 디렉터리 구조 (*******************)
 
     tomcat/webapps   <==== 배포경로 ( deploy path )

                  HelloTest  <== 웹 어플리케이션 (물리적인 디렉터리 )
                       META-INF
		       WEB-INF
		           classes <== *.java에 대한 *.class 파일들이 저장
			   lib     <== *.jar 저장 
			   web.xml <== 설정 정보 저장
			   
		       main.jsp
		       css
		       js
		       image



 7. 서버에 작성 가능한 3가지 컴포넌트 


    클라이언트              요청          서버(tomcat: 8090)
   (웹브라우저)  ----------------------->  
                                       1) html (정적 컴포넌트)
                                          src/main/webapp 에 저장
				       2) jsp  (동적 컴포넌트)
				          src/main/webapp 에 저장
				       3) 서블릿 (동적 컴포넌트)
				          src/main/java 에 저장

	      <---------------------
	                 응답

 8. 3가지 컴포넌트 웹 브라우저에서 요청하는 URL

   문법: 
         http://서버IP:port번호/컨텍스트명/자원(html/JSP/Servlet)


    1) 정적 컴포넌트 ( html ) - 디렉터리 없는 경우

     요청 URL:  http://서버IP:port번호/컨텍스트명/html자원




    클라이언트                         서버(tomcat: 8090)
   (웹브라우저)                          main.html
           a. http://localhost:8090/컨텍스트명/main.html
	   ----------------------->  
	                             b. main.html 검색
				       만약 없으면 404 에러 발생
				       있으면 다운로드 해줌
           <----------------------
	    c. main.html 다운로드

   d. main.html
    랜더링

    1) 정적 컴포넌트 ( html ) - 디렉터리 있는 경우

     요청 URL:  http://서버IP:port번호/컨텍스트명/디렉터리명/html자원


    클라이언트                         서버(tomcat: 8090)
   (웹브라우저)                          html/main.html
           a. http://localhost:8090/컨텍스트명/html/main.html
	   ----------------------->  
	                             b. main.html 검색
				       만약 없으면 404 에러 발생
				       있으면 다운로드 해줌
           <----------------------
	    c. main.html 다운로드

   d. main.html
    랜더링


    2) JSP 요청 ( 동적 컴포넌트 ) - 디렉터리 없는 경우

     요청 URL:  http://서버IP:port번호/컨텍스트명/jsp자원

    클라이언트                         서버(tomcat: 8090)
   (웹브라우저)                           main.jsp

           a. http://localhost:8090/컨텍스트명/main.jsp
	   ----------------------->  
	                              b. main.jsp 검색
				       만약 없으면 404 에러 발생
				       있으면 3단계 실행됨 (**********************)
				   확인방법: C:\servlet_study\apache-tomcat-10.1.28\work\컨텍스트명폴더
				   
				         가. 변환단계
					   main.jsp ------> main_jsp.java

					 나. 컴파일 단계
					   main_jsp.java --> main_jsp.class

					 다. 실행 단계
					  main_jsp.class ==>  html로 결과가 나옴.

	   <----------------------
	    c.  html 다운로드
				 
 d. html 랜더링					 

				        